<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Live Demo | x402 Labs - Micropayments for the Machine Economy</title>
  <link rel="icon" type="image/png" href="/assets/xlabs-new.png">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  
  <!-- Core Dependencies -->
  <script src="js/buffer-polyfill.js"></script>
  <script src="https://unpkg.com/@solana/web3.js@1.73.0/lib/index.iife.min.js"></script>
  <script src="js/spl-token-utils.js"></script>
  <script src="js/bs58-polyfill.js"></script>
  <script src="js/payai-init.js"></script>
  
  <!-- x402 Labs theme (design.svg palette) -->
  <style>
    :root {
      --bg: #DFEFFB;
      --bg2: #E8F4F8;
      --text: #0E4D81;
      --primary: #177CCF;
      --primaryDark: #0E4D81;
      --card: #FFFFFF;
      --soft: #E7F1F9;
      --muted: #6B8CA8;
    }
    body { background: linear-gradient(135deg, var(--bg) 0%, var(--bg2) 100%) !important; color: var(--text) !important; }
    /* Map dark utility classes to light theme locally */
    .bg-gray-900 { background-color: var(--bg) !important; }
    .bg-gray-800 { background-color: var(--card) !important; border: 1px solid rgba(23,124,207,0.15); box-shadow: 0 6px 20px rgba(14,77,129,0.06); }
    .bg-gray-700 { background-color: var(--soft) !important; color: var(--text) !important; }
    .text-white { color: var(--text) !important; }
    .text-gray-400 { color: var(--muted) !important; }
    .text-blue-300 { color: var(--primary) !important; }
    .text-purple-400 { color: var(--primary) !important; }
    .bg-blue-600, .bg-purple-600, .bg-green-600 { background: linear-gradient(135deg, var(--primary) 0%, var(--primaryDark) 100%) !important; }
    .hover\:bg-blue-700:hover, .hover\:bg-purple-700:hover, .hover\:bg-green-700:hover { filter: brightness(0.95); }
    pre.bg-gray-900 { background-color: var(--soft) !important; color: var(--text) !important; }
    /* Inputs */
    input#wallet, input#params, select#method, select#facilitator { border: 1px solid rgba(23,124,207,0.15); }
    /* Back link */
    a[href="/"] { color: var(--primary) !important; }
    /* Status panels */
    .bg-orange-900 { background-color: rgba(23,124,207,0.08) !important; }
    .border-orange-500 { border-color: rgba(23,124,207,0.35) !important; }
    .log-pane {
      background-color: var(--soft) !important;
      color: var(--text) !important;
      border-radius: 0.75rem;
      padding: 0.75rem;
      font-size: 0.75rem;
      max-height: 14rem;
      overflow: auto;
      transition: max-height 0.25s ease;
    }
    .log-pane.expanded {
      max-height: 32rem;
    }
    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .panel-actions {
      display: flex;
      gap: 0.5rem;
    }
    .panel-button {
      font-size: 0.75rem;
      font-weight: 600;
      padding: 0.35rem 0.75rem;
      border-radius: 999px;
      border: 1px solid rgba(23,124,207,0.25);
      background: rgba(23,124,207,0.08);
      color: var(--primaryDark);
      transition: background 0.2s ease, transform 0.2s ease;
    }
    .panel-button:hover {
      background: rgba(23,124,207,0.15);
      transform: translateY(-1px);
    }
    .panel-button.is-active {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primaryDark) 100%);
      color: #fff;
      border-color: transparent;
    }
  </style>
  
  <!-- Header Navigation (consistent across all pages) -->
  <style>
    .main-header {
      background: rgba(30, 41, 59, 0.5);
      backdrop-filter: blur(10px);
      padding: 1rem 2rem;
      border-bottom: 1px solid rgba(139, 92, 246, 0.1);
    }
    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .main-nav {
      display: flex;
      gap: 1.5rem;
      align-items: center;
    }
    .main-nav a {
      color: #cbd5e1;
      text-decoration: none;
      font-weight: 500;
      font-size: 0.9rem;
    }
    .main-nav a:hover {
      color: #a78bfa;
      text-decoration: none;
    }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">

  <!-- Header -->
  <header class="main-header">
    <div class="header-content">
      <a href="/" style="display: flex; align-items: center;">
        <img src="/assets/xlabs-new.png" alt="x402 Labs" style="height: 64px; width: auto;">
      </a>
      <nav class="main-nav">
        <a href="/">Home</a>
        <a href="/api-docs">API Docs</a>
        <a href="/api-reference">API Reference</a>
        <a href="/providers-ui">Providers</a>
        <a href="/demo">Demo</a>
        <a href="https://x.com/x402labs" target="_blank" rel="noopener noreferrer" style="display: inline-flex; align-items: center;">
          <svg viewBox="0 0 24 24" style="width: 14px; height: 14px; fill: currentColor;">
            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
          </svg>
        </a>
        <a href="https://github.com/x402-labs" target="_blank" rel="noopener noreferrer">
          <svg viewBox="0 0 24 24" style="width: 14px; height: 14px; fill: currentColor;">
            <path d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"/>
          </svg>
        </a>
      </nav>
    </div>
  </header>

  <div class="container mx-auto px-6 py-12">
    <div class="flex items-center justify-between mb-8">
      <h1 class="text-4xl font-bold">Live Demo: Pay with x402</h1>
    </div>
    <p class="text-gray-400 mb-8">Micropayments for the Machine Economyâ„¢</p>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <!-- LEFT: Controls -->
      <div class="space-y-6">
        <div class="bg-gray-800 p-6 rounded-xl">
          <h2 class="text-xl font-semibold mb-4">1. Connect Wallet</h2>
          <button id="connect" class="w-full px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg font-semibold">
            Connect Phantom Wallet to try demo.
          </button>
          <p id="wallet" class="mt-2 text-sm text-gray-400"></p>
        </div>

        <div class="bg-gray-800 p-6 rounded-xl">
          <h2 class="text-xl font-semibold mb-4">2. Make RPC Call</h2>
          <label class="block text-sm font-medium text-gray-300 mb-2">Network</label>
          <select id="chain" class="w-full p-2 bg-gray-700 rounded mb-2">
            <option value="solana">Solana</option>
            <option value="base">Base</option>
          </select>
          <p class="text-xs text-gray-400 mb-3 italic">Choose the chain. Solana supports CodeNut, PayAI, or x402labs. Base currently routes through CodeNut.</p>
          <label class="block text-sm font-medium text-gray-300 mb-2">Payment Facilitator</label>
          <select id="facilitator" class="w-full p-2 bg-gray-700 rounded mb-1">
            <option value="codenut">CodeNut Pay - USDC (Solana/Base)</option>
            <option value="corbits">Corbits - USDC (Solana/Base/Polygon)</option>
            <option value="payai">PayAI Network - USDC (Solana)</option>
            <option value="x402labs" selected> x402labs - SOL (Solana) - Self-hosted, full control</option>
          </select>
          <p id="facilitator-help" class="text-xs text-gray-400 mb-3 italic">Choose how you want to pay: USDC (CodeNut/PayAI) or SOL (x402labs)</p>
          <select id="method" class="w-full p-2 bg-gray-700 rounded mb-3">
            <option value="getSlot">getSlot (Solana) - no params needed</option>
            <option value="getBalance">getBalance (Solana) - needs address</option>
            <option value="getAccountInfo">getAccountInfo (Solana) - get account data</option>
            <option value="getTransaction">getTransaction (Solana) - get tx by signature</option>
            <option value="getTokenAccountsByOwner">getTokenAccountsByOwner (Solana) - SPL tokens</option>
            <option value="getSignaturesForAddress">getSignaturesForAddress (Solana) - tx history</option>
            <option value="sendTransaction">sendTransaction (Solana) - broadcast tx</option>
            <option value="eth_blockNumber">eth_blockNumber (Base)</option>
          </select>
          <input id="params" placeholder='Empty for getSlot, or paste address for getBalance' class="w-full p-2 bg-gray-700 rounded mb-3 text-sm" />
          <button id="buildTx" class="w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm mb-2" style="display:none;">
            ðŸ“¦ Build Sample Transaction
          </button>
          <button id="call" class="w-full px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-semibold">
            Call RPC
          </button>
        </div>

        <div id="status" class="bg-gray-800 p-4 rounded-xl text-sm"></div>
      </div>

      <!-- RIGHT: Response -->
      <div class="space-y-6">
        <div class="bg-gray-800 p-6 rounded-xl">
          <div class="panel-header">
            <h2 class="text-xl font-semibold">Request</h2>
            <div class="panel-actions">
              <button class="panel-button" data-copy="request">Copy</button>
              <button class="panel-button" data-toggle="request">Expand</button>
            </div>
          </div>
          <pre id="request" class="log-pane text-green-400"></pre>
        </div>

        <div class="bg-gray-800 p-6 rounded-xl">
          <div class="panel-header">
            <h2 class="text-xl font-semibold">Response</h2>
            <div class="panel-actions">
              <button class="panel-button" data-copy="response">Copy</button>
              <button class="panel-button" data-toggle="response">Expand</button>
            </div>
          </div>
          <pre id="response" class="log-pane text-blue-300"></pre>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Application Logic -->
  <script src="js/demo.js"></script>

  <!-- Real-Time Pricing Widget -->
  <script src="/shared-pricing-widget.js"></script>
</body>
</html>
