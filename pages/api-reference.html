<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  
  <!-- SEO Meta Tags -->
  <title>API Reference | x402-RPC-Aggregator Documentation</title>
  <meta name="description" content="Complete API reference for x402-RPC-Aggregator. Learn how to integrate intelligent RPC routing with x402 micropayments in your AI agents and dApps." />
  <meta name="keywords" content="x402 API, RPC API, Solana API, Ethereum API, blockchain API, micropayments API" />
  
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìñ</text></svg>" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background: #0f172a;
      color: #f1f5f9;
      line-height: 1.6;
    }
    
    code, pre {
      font-family: 'JetBrains Mono', monospace;
    }
    
    /* Header */
    header {
      background: rgba(30, 41, 59, 0.5);
      backdrop-filter: blur(10px);
      padding: 1rem 2rem;
      position: sticky;
      top: 0;
      z-index: 100;
      border-bottom: 1px solid rgba(139, 92, 246, 0.1);
    }
    
    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .logo {
      font-size: 1.25rem;
      font-weight: 700;
      color: #a78bfa;
      text-decoration: none;
    }
    
    nav {
      display: flex;
      gap: 2rem;
    }
    
    nav a {
      color: #cbd5e1;
      text-decoration: none;
      font-weight: 500;
    }
    
    nav a:hover {
      color: #a78bfa;
    }
    
    /* Layout */
    .container {
      display: grid;
      grid-template-columns: 250px 1fr;
      max-width: 1400px;
      margin: 0 auto;
      min-height: calc(100vh - 73px);
    }
    
    /* Sidebar */
    .sidebar {
      background: rgba(30, 41, 59, 0.3);
      padding: 2rem 1.5rem;
      border-right: 1px solid rgba(139, 92, 246, 0.1);
      position: sticky;
      top: 73px;
      height: calc(100vh - 73px);
      overflow-y: auto;
    }
    
    .sidebar h3 {
      font-size: 0.875rem;
      color: #64748b;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 1rem;
      margin-top: 2rem;
    }
    
    .sidebar h3:first-child {
      margin-top: 0;
    }
    
    .sidebar ul {
      list-style: none;
    }
    
    .sidebar li {
      margin-bottom: 0.5rem;
    }
    
    .sidebar a {
      color: #cbd5e1;
      text-decoration: none;
      font-size: 0.9rem;
      display: block;
      padding: 0.5rem;
      border-radius: 0.375rem;
      transition: all 0.2s;
    }
    
    .sidebar a:hover,
    .sidebar a.active {
      background: rgba(139, 92, 246, 0.1);
      color: #a78bfa;
    }
    
    /* Content */
    .content {
      padding: 3rem;
    }
    
    .section {
      margin-bottom: 4rem;
    }
    
    h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, #f1f5f9 0%, #a78bfa 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    h2 {
      font-size: 2rem;
      margin-top: 3rem;
      margin-bottom: 1.5rem;
      color: #e2e8f0;
      border-bottom: 1px solid rgba(139, 92, 246, 0.2);
      padding-bottom: 0.5rem;
    }
    
    h3 {
      font-size: 1.5rem;
      margin-top: 2rem;
      margin-bottom: 1rem;
      color: #cbd5e1;
    }
    
    p {
      color: #cbd5e1;
      margin-bottom: 1rem;
      max-width: 800px;
    }
    
    /* Code Blocks */
    pre {
      background: #1e293b;
      border-radius: 0.75rem;
      padding: 1.5rem;
      overflow-x: auto;
      margin: 1.5rem 0;
      border: 1px solid rgba(139, 92, 246, 0.2);
    }
    
    code {
      color: #10b981;
      font-size: 0.9rem;
    }
    
    .inline-code {
      background: rgba(139, 92, 246, 0.1);
      padding: 0.2rem 0.5rem;
      border-radius: 0.25rem;
      color: #a78bfa;
      font-size: 0.9em;
    }
    
    /* API Endpoint Cards */
    .endpoint-card {
      background: rgba(30, 41, 59, 0.5);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
      border: 1px solid rgba(139, 92, 246, 0.2);
    }
    
    .endpoint-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    
    .method {
      background: #10b981;
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 0.375rem;
      font-weight: 600;
      font-size: 0.875rem;
    }
    
    .method.post {
      background: #3b82f6;
    }
    
    .method.get {
      background: #10b981;
    }
    
    .endpoint-path {
      font-family: 'JetBrains Mono', monospace;
      color: #a78bfa;
      font-weight: 500;
    }
    
    .parameter-table {
      width: 100%;
      margin: 1.5rem 0;
      border-collapse: collapse;
    }
    
    .parameter-table th {
      text-align: left;
      padding: 0.75rem;
      background: rgba(139, 92, 246, 0.1);
      border-bottom: 1px solid rgba(139, 92, 246, 0.2);
      font-size: 0.875rem;
      color: #cbd5e1;
    }
    
    .parameter-table td {
      padding: 0.75rem;
      border-bottom: 1px solid rgba(139, 92, 246, 0.1);
      color: #94a3b8;
    }
    
    .parameter-name {
      font-family: 'JetBrains Mono', monospace;
      color: #a78bfa;
    }
    
    .required {
      background: #ef4444;
      color: white;
      padding: 0.125rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      font-weight: 600;
      margin-left: 0.5rem;
    }
    
    .optional {
      background: #64748b;
      color: white;
      padding: 0.125rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      font-weight: 600;
      margin-left: 0.5rem;
    }
    
    /* Response Examples */
    .response-tabs {
      display: flex;
      gap: 1rem;
      margin: 1.5rem 0 0;
    }
    
    .tab {
      background: rgba(139, 92, 246, 0.1);
      color: #cbd5e1;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem 0.5rem 0 0;
      cursor: pointer;
      font-weight: 500;
      font-size: 0.875rem;
    }
    
    .tab.active {
      background: #1e293b;
      color: #a78bfa;
    }
    
    /* Status Badge */
    .status-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      font-weight: 600;
      margin-left: 1rem;
    }
    
    .status-badge.live {
      background: #10b981;
      color: white;
    }
    
    .status-badge.beta {
      background: #f59e0b;
      color: white;
    }
    
    /* Quick Links */
    .quick-links {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin: 2rem 0;
    }
    
    .quick-link {
      background: rgba(139, 92, 246, 0.1);
      padding: 1.5rem;
      border-radius: 0.75rem;
      border: 1px solid rgba(139, 92, 246, 0.2);
      text-decoration: none;
      color: inherit;
      transition: all 0.3s;
    }
    
    .quick-link:hover {
      transform: translateY(-3px);
      border-color: rgba(139, 92, 246, 0.4);
    }
    
    .quick-link h4 {
      color: #a78bfa;
      margin-bottom: 0.5rem;
    }
    
    .quick-link p {
      font-size: 0.875rem;
      color: #94a3b8;
    }
    
    @media (max-width: 1024px) {
      .container {
        grid-template-columns: 1fr;
      }
      
      .sidebar {
        display: none;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="header-content">
      <a href="/" class="logo">‚ö° x402-RPC API Docs</a>
      <nav>
        <a href="/">Home</a>
        <a href="/api-docs">API Docs</a>
        <a href="/api-reference">API Reference</a>
        <a href="/providers-ui">Providers</a>
        <a href="/demo">Demo</a>
        <a href="https://x.com/x402labs" target="_blank" rel="noopener noreferrer" style="display: inline-flex; align-items: center; gap: 0.3rem;">
          <svg viewBox="0 0 24 24" style="width: 14px; height: 14px; fill: currentColor;">
            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
          </svg>
        </a>
        <a href="https://github.com/x402-labs" target="_blank" rel="noopener noreferrer">
          <svg viewBox="0 0 24 24" style="width: 14px; height: 14px; fill: currentColor;">
            <path d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"/>
          </svg>
        </a>
      </nav>
    </div>
  </header>

  <!-- Main Container -->
  <div class="container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <h3>Getting Started</h3>
      <ul>
        <li><a href="#introduction" class="active">Introduction</a></li>
        <li><a href="#quick-start">Quick Start</a></li>
        <li><a href="#authentication">Authentication</a></li>
      </ul>
      
      <h3>Core API</h3>
      <ul>
        <li><a href="#rpc-endpoint">RPC Endpoint</a></li>
        <li><a href="#x402-payment">x402-payment Header</a></li>
        <li><a href="#health">Health Check</a></li>
        <li><a href="#providers">Providers</a></li>
      </ul>
      
      <h3>Advanced</h3>
      <ul>
        <li><a href="#routing">Routing Strategies</a></li>
        <li><a href="#batch-payments">Batch Payments</a></li>
        <li><a href="#error-handling">Error Handling</a></li>
      </ul>
      
      <h3>SDKs</h3>
      <ul>
        <li><a href="#javascript">JavaScript</a></li>
        <li><a href="#python">Python</a></li>
        <li><a href="#curl">cURL</a></li>
      </ul>
      
      <h3>Support</h3>
      <ul>
        <li><a href="#faq">FAQ</a></li>
      </ul>
    </aside>

    <!-- Main Content -->
    <main class="content">
      <!-- Introduction -->
      <section id="introduction" class="section">
        <h1>API Reference</h1>
        <p>
          Complete documentation for integrating x402-RPC-Aggregator into your applications. 
          This API provides intelligent RPC routing with built-in x402 micropayment support for Solana, Ethereum, and Base chains.
        </p>
        
        <div class="quick-links">
          <a href="#quick-start" class="quick-link">
            <h4>üöÄ Quick Start</h4>
            <p>Get started in 5 minutes</p>
          </a>
          <a href="/demo" class="quick-link">
            <h4>üéÆ Live Demo</h4>
            <p>Try it in your browser</p>
          </a>
          <a href="/api-docs" class="quick-link">
            <h4>üìä Swagger UI</h4>
            <p>Interactive API explorer</p>
          </a>
          <a href="https://github.com/x402-labs/x402-rpc-aggregator" class="quick-link">
            <h4>üíª GitHub</h4>
            <p>View source code</p>
          </a>
        </div>
      </section>

      <!-- Quick Start -->
      <section id="quick-start" class="section">
        <h2>Quick Start</h2>
        <p>Make your first RPC call in less than 5 minutes.</p>
        
        <h3>1. Make an RPC Request</h3>
<pre><code>curl -X POST https://x402labs.cloud/rpc \
  -H "Content-Type: application/json" \
  -d '{
    "method": "getSlot",
    "chain": "solana"
  }'</code></pre>

        <h3>2. Receive 402 Payment Challenge</h3>
<pre><code>{
  "invoice": {
    "amount": 0.0001,
    "to": "FacilitatorWalletAddress...",
    "network": "solana-mainnet",
    "provider": "Triton One",
    "nonce": "1730000000000-abc123"
  }
}</code></pre>

        <h3>3. Pay and Retry (Automatic with SDK)</h3>
<pre><code>import { X402Agent } from './x402-client';

const agent = new X402Agent('https://x402labs.cloud/');
const result = await agent.callRPC('getSlot', [], 'solana');

console.log('Slot:', result.result);
console.log('Tx Hash:', result.x402.paymentInfo.txHash);</code></pre>
      </section>

      <!-- Authentication -->
      <section id="authentication" class="section">
        <h2>Authentication <span class="status-badge live">LIVE</span></h2>
        <p>
          x402-RPC-Aggregator uses the x402 protocol for authentication. Instead of API keys, 
          you pay per request using USDC micropayments on Solana or Base.
        </p>
        
        <h3>Payment Flow</h3>
        <ol style="margin-left: 2rem; color: #cbd5e1;">
          <li>Make request without payment ‚Üí Receive 402 with invoice</li>
          <li>Sign payment with wallet (Phantom/MetaMask)</li>
          <li>Retry request with <span class="inline-code">x402-payment</span> header</li>
          <li>Facilitator verifies & settles payment</li>
          <li>Receive RPC response with receipt</li>
        </ol>
      </section>

      <!-- RPC Endpoint -->
      <section id="rpc-endpoint" class="section">
        <h2>RPC Endpoint <span class="status-badge live">LIVE</span></h2>
        
        <div class="endpoint-card">
          <div class="endpoint-header">
            <span class="method post">POST</span>
            <span class="endpoint-path">/rpc</span>
          </div>
          
          <p>Execute an RPC call with intelligent provider routing and x402 payment.</p>
          
          <h3>Request Body</h3>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="parameter-name">method</span><span class="required">required</span></td>
                <td>string</td>
                <td>RPC method name (e.g., "getSlot", "eth_blockNumber")</td>
              </tr>
              <tr>
                <td><span class="parameter-name">params</span><span class="optional">optional</span></td>
                <td>array</td>
                <td>Method parameters (default: [])</td>
              </tr>
              <tr>
                <td><span class="parameter-name">chain</span><span class="optional">optional</span></td>
                <td>string</td>
                <td>Blockchain: "solana" | "ethereum" | "base" (default: "solana")</td>
              </tr>
              <tr>
                <td><span class="parameter-name">preferences</span><span class="optional">optional</span></td>
                <td>object</td>
                <td>Routing preferences (see <a href="#routing" style="color: #a78bfa;">Routing Strategies</a>)</td>
              </tr>
              <tr>
                <td><span class="parameter-name">facilitator</span><span class="optional">optional</span></td>
                <td>string</td>
                <td>Payment facilitator: "x402labs" (SOL) or "payai" (USDC). <strong>Important for SOL payments!</strong></td>
              </tr>
            </tbody>
          </table>
          
          <h3>Response (200 Success)</h3>
<pre><code>{
  "jsonrpc": "2.0",
  "id": 1,
  "result": 182456789,
  "x402": {
    "provider": "Triton One",
    "paymentInfo": {
      "provider": "solana",
      "chain": "solana",
      "txHash": "5x...",
      "amount": 0.0001,
      "explorer": "https://orb.helius.dev/tx/5x..."
    },
    "cost": 0.0001,
    "status": "settled"
  }
}</code></pre>

          <h3>Response (402 Payment Required)</h3>
<pre><code>{
  "invoice": {
    "amount": 0.0001,
    "to": "FacilitatorWallet...",
    "network": "solana-mainnet",
    "resource": "/rpc",
    "nonce": "unique-nonce",
    "provider": "Triton One",
    "batchOption": {
      "calls": 1000,
      "price": 0.08,
      "savings": "20%"
    }
  }
}</code></pre>
        </div>
      </section>

      <!-- x402 Payment Header -->
      <section id="x402-payment" class="section">
        <h2>x402-payment Header Format <span class="status-badge live">REQUIRED</span></h2>
        
        <p style="color: #cbd5e1; margin-bottom: 2rem;">
          The <span class="inline-code">x402-payment</span> header contains payment proof for accessing RPC endpoints.
          It must be a JSON string with payment payload and requirements.
        </p>

        <h3>Header Structure</h3>
        <div class="endpoint-card">
<pre><code>Header: x402-payment
Value: JSON string

{
  "paymentPayload": {
    // Payment proof (varies by facilitator)
  },
  "paymentRequirements": {
    // Payment details
  }
}</code></pre>
        </div>

        <h3>x402labs Facilitator (SOL Payments)</h3>
        <div class="endpoint-card">
          <p style="color: #cbd5e1; margin-bottom: 1rem;">For x402labs facilitator, include signed transaction:</p>
<pre><code>{
  "paymentPayload": {
    "signedIntent": {
      "publicKey": "3HBV2F9C25k8169rKv6FDqaFHj52NYH5JJjFYDo5nAZ",
      "signature": "5x1y2z3a4b..."  // Base58-encoded ed25519 signature
    },
    "txBase64": "26pM95XT8BuZ...",  // Base58-encoded serialized transaction
    "network": "solana",  // or "solana-mainnet" (auto-normalized)
    "paymentType": "SOL"  // Optional
  },
  "paymentRequirements": {
    "amount": 749,  // In lamports (749 = 0.000000749 SOL ‚âà $0.00015)
    "recipient": "26AvBMEXaJAfA2R7wtQiPNYeWUd8QSi6rvy5i5W78vNR",
    "nonce": "1762210242077-0.492",
    "resource": "/rpc"  // Optional
  }
}</code></pre>
          <p style="color: #a78bfa; font-size: 0.875rem; margin-top: 1rem;">
            üí° Payment Intent Message (what gets signed):
          </p>
<pre><code>{
  "amount": 749,
  "to": "26AvBMEXaJAfA2R7wtQiPNYeWUd8QSi6rvy5i5W78vNR",
  "nonce": "1762210242077-0.492",
  "resource": "/rpc"
}</code></pre>
        </div>

        <h3>PayAI Network Facilitator (USDC Payments)</h3>
        <div class="endpoint-card">
          <p style="color: #cbd5e1; margin-bottom: 1rem;">For PayAI facilitator, build USDC transfer with facilitator as fee payer:</p>
<pre><code>{
  "paymentPayload": {
    "x402Version": 1,
    "scheme": "exact",
    "network": "solana",
    "payload": {
      "transaction": "AgAAAA..."  // Base64-encoded partially-signed transaction
    }
  },
  "paymentRequirements": {
    "scheme": "exact",
    "network": "solana",
    "maxAmountRequired": "150",  // In micro-USDC (150 = 0.000150 USDC ‚âà $0.00015)
    "asset": {
      "address": "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"
    },
    "payTo": "26AvBMEXaJAfA2R7wtQiPNYeWUd8QSi6rvy5i5W78vNR",
    "resource": "/rpc",
    "description": "x402 RPC payment",
    "extra": {
      "feePayer": "2wKupLR9q6wXYppw8Gr2NvWxKBUqm4PPJKkQfoxHDBg4"
    }
  }
}</code></pre>
        </div>

        <h3>Amount Units Reference</h3>
        <div class="endpoint-card">
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Base Unit</th>
                <th>Decimals</th>
                <th>Example</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>SOL</strong></td>
                <td>lamports</td>
                <td>9</td>
                <td>749 lamports = 0.000000749 SOL ‚âà $0.00015</td>
              </tr>
              <tr>
                <td><strong>USDC</strong></td>
                <td>micro-USDC</td>
                <td>6</td>
                <td>150 micro-USDC = 0.000150 USDC = $0.00015</td>
              </tr>
              <tr>
                <td><strong>ETH</strong></td>
                <td>wei</td>
                <td>18</td>
                <td>5e14 wei = 0.0005 ETH ‚âà $1.50</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>Usage Example</h3>
        <div class="endpoint-card">
          <p style="color: #cbd5e1; margin-bottom: 1rem;">JavaScript example:</p>
<pre><code>const payment = {
  paymentPayload: {
    signedIntent: { /* ... */ },
    txBase64: "...",  // x402labs only
    network: "solana"
  },
  paymentRequirements: {
    amount: 749,
    recipient: "26AvBMEXaJAfA2R7wtQiPNYeWUd8QSi6rvy5i5W78vNR",
    nonce: `${Date.now()}-${Math.random()}`
  }
};

const response = await fetch('https://x402labs.cloud/rpc', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'x402-payment': JSON.stringify(payment)  // ‚Üê Stringified JSON
  },
  body: JSON.stringify({
    method: 'getSlot',
    params: [],
    chain: 'solana'
  })
});</code></pre>
        </div>

        <h3>Validation Rules</h3>
        <div class="endpoint-card">
          <p style="color: #cbd5e1; margin-bottom: 1rem;">The payment header is validated for:</p>
          <ul style="list-style-type: disc; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li>Valid JSON format</li>
            <li>Ed25519 signature verification (x402labs only)</li>
            <li>Recipient matches treasury wallet</li>
            <li>Nonce is unique (prevents replay attacks)</li>
            <li><strong>x402labs:</strong> Transaction contains valid SOL transfer (‚â•890,880 lamports)</li>
            <li><strong>PayAI:</strong> Partially-signed USDC transaction verified by PayAI Network</li>
          </ul>
        </div>
      </section>

      <!-- Health Endpoint -->
      <section id="health" class="section">
        <h2>Health Check</h2>
        
        <div class="endpoint-card">
          <div class="endpoint-header">
            <span class="method get">GET</span>
            <span class="endpoint-path">/health</span>
          </div>
          
          <p>Check service health and provider status.</p>
          
<pre><code>curl https://x402labs.cloud//health</code></pre>

          <h3>Response</h3>
<pre><code>{
  "status": "ok",
  "timestamp": "2025-10-27T12:00:00.000Z",
  "version": "1.0.0",
  "chains": ["solana", "ethereum", "base"],
  "stats": {
    "totalProviders": 8,
    "activeProviders": 8,
    "healthyProviders": 7,
    "averageLatency": 312
  }
}</code></pre>
        </div>
      </section>

      <!-- Providers Endpoint -->
      <section id="providers" class="section">
        <h2>List Providers</h2>
        
        <div class="endpoint-card">
          <div class="endpoint-header">
            <span class="method get">GET</span>
            <span class="endpoint-path">/providers</span>
          </div>
          
          <p>Get list of all RPC providers with real-time health status.</p>
          
          <h3>Query Parameters</h3>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="parameter-name">chain</span><span class="optional">optional</span></td>
                <td>string</td>
                <td>Filter by chain: "solana" | "ethereum" | "base"</td>
              </tr>
            </tbody>
          </table>
          
<pre><code>curl 'https://x402labs.cloud//providers?chain=solana'</code></pre>

          <h3>Response</h3>
<pre><code>{
  "providers": [
    {
      "id": "triton-solana",
      "name": "Triton One",
      "chains": ["solana"],
      "costPerCall": 0.0001,
      "batchCost": { "calls": 1000, "price": 0.08 },
      "status": "active",
      "priority": 100,
      "averageLatency": 245
    }
  ],
  "total": 1
}</code></pre>
        </div>
      </section>

      <!-- Routing Strategies -->
      <section id="routing" class="section">
        <h2>Routing Strategies <span class="status-badge live">LIVE</span></h2>
        <p>Customize how the aggregator selects RPC providers for your requests.</p>
        
        <h3>Available Strategies</h3>
        
        <div class="endpoint-card">
          <h4>1. Lowest Cost (Default)</h4>
          <p>Selects the provider with the lowest cost per call.</p>
<pre><code>{
  "method": "getSlot",
  "chain": "solana",
  "preferences": {
    "strategy": "lowest-cost"
  }
}</code></pre>
        </div>

        <div class="endpoint-card">
          <h4>2. Lowest Latency</h4>
          <p>Selects the fastest provider based on real-time health checks.</p>
<pre><code>{
  "method": "getSlot",
  "chain": "solana",
  "preferences": {
    "strategy": "lowest-latency",
    "maxLatencyMs": 2000
  }
}</code></pre>
        </div>

        <div class="endpoint-card">
          <h4>3. Highest Priority</h4>
          <p>Uses premium providers first (e.g., Triton One for Solana).</p>
<pre><code>{
  "method": "getSlot",
  "chain": "solana",
  "preferences": {
    "strategy": "highest-priority"
  }
}</code></pre>
        </div>

        <div class="endpoint-card">
          <h4>4. Round Robin</h4>
          <p>Distributes load evenly across all providers.</p>
<pre><code>{
  "method": "getSlot",
  "chain": "solana",
  "preferences": {
    "strategy": "round-robin"
  }
}</code></pre>
        </div>
      </section>

      <!-- Batch Payments -->
      <section id="batch-payments" class="section">
        <h2>Batch Payments <span class="status-badge live">LIVE</span></h2>
        <p>Purchase multiple calls upfront for discounted pricing (20% savings).</p>
        
        <h3>Get Batch Pricing</h3>
<pre><code>curl 'https://x402labs.cloud/batch-pricing?chain=solana'</code></pre>

        <h3>Response</h3>
<pre><code>{
  "chain": "solana",
  "batchOptions": [
    {
      "providerId": "triton-solana",
      "providerName": "Triton One",
      "calls": 1000,
      "price": 0.08,
      "pricePerCall": 0.00008,
      "savings": "20.0%"
    }
  ]
}</code></pre>

        <h3>Purchase Batch</h3>
        <p>Include <span class="inline-code">batchPurchase: true</span> in payment payload to buy a batch.</p>
        
        <h3>Use Batch</h3>
        <p>Include batch ID in header for subsequent calls:</p>
<pre><code>curl -X POST /rpc \
  -H "x402-batch: {\"batchId\": \"batch_123...\"}" \
  -d '{"method":"getSlot","chain":"solana"}'</code></pre>
      </section>

      <!-- Error Handling -->
      <section id="error-handling" class="section">
        <h2>Error Handling</h2>
        
        <h3>HTTP Status Codes</h3>
        <table class="parameter-table">
          <thead>
            <tr>
              <th>Code</th>
              <th>Meaning</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>200</strong></td>
              <td>Success</td>
              <td>Payment settled, RPC executed</td>
            </tr>
            <tr>
              <td><strong>402</strong></td>
              <td>Payment Required</td>
              <td>Pay invoice and retry</td>
            </tr>
            <tr>
              <td><strong>400</strong></td>
              <td>Bad Request</td>
              <td>Check request parameters</td>
            </tr>
            <tr>
              <td><strong>404</strong></td>
              <td>Not Found</td>
              <td>Check endpoint URL</td>
            </tr>
            <tr>
              <td><strong>500</strong></td>
              <td>Server Error</td>
              <td>Retry with fallback provider</td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- JavaScript SDK -->
      <section id="javascript" class="section">
        <h2>JavaScript/TypeScript SDK</h2>
        
<pre><code>import { X402Agent } from './lib/x402-client';

// Initialize agent
const agent = new X402Agent('https://x402labs.cloud/');

// Make RPC call (handles payment automatically)
const result = await agent.callRPC('getSlot', [], 'solana');

console.log('Current slot:', result.result);
console.log('Payment tx:', result.x402.paymentInfo.txHash);</code></pre>

        <h3>With Preferences</h3>
<pre><code>const result = await agent.callRPC(
  'getBalance',
  ['SomeWalletAddress...'],
  'solana',
  {
    strategy: 'lowest-latency',
    maxLatencyMs: 1500,
    preferredProviders: ['triton-solana']
  }
);</code></pre>
      </section>

      <!-- Python Example -->
      <section id="python" class="section">
        <h2>Python (Concept)</h2>
        
<pre><code>from x402_client import X402Agent

# Initialize
agent = X402Agent('https://x402labs.cloud/')

# Make call
result = agent.call_rpc('getSlot', [], chain='solana')
print(f"Slot: {result['result']}")
print(f"Tx: {result['x402']['paymentInfo']['txHash']}")</code></pre>
      </section>

      <!-- cURL Examples -->
      <section id="curl" class="section">
        <h2>cURL Examples</h2>
        
        <h3>Solana - Get Slot</h3>
<pre><code>curl -X POST https://x402labs.cloud/rpc \
  -H "Content-Type: application/json" \
  -d '{
    "method": "getSlot",
    "chain": "solana"
  }'</code></pre>

        <h3>Ethereum - Block Number</h3>
<pre><code>curl -X POST https://x402labs.cloud/rpc \
  -H "Content-Type: application/json" \
  -d '{
    "method": "eth_blockNumber",
    "chain": "ethereum"
  }'</code></pre>

        <h3>With Custom Routing</h3>
<pre><code>curl -X POST https://x402labs.cloud/rpc \
  -H "Content-Type: application/json" \
  -d '{
    "method": "getSlot",
    "chain": "solana",
    "preferences": {
      "strategy": "lowest-latency",
      "maxLatencyMs": 2000
    }
  }'</code></pre>
      </section>

      <!-- Footer -->
      <section style="margin-top: 6rem; padding-top: 3rem; border-top: 1px solid rgba(139, 92, 246, 0.1);">
        <p style="color: #64748b; text-align: center;">
          Need help? Check out <a href="https://github.com/x402-labs" style="color: #a78bfa;">GitHub</a> or visit the 
          <a href="/demo" style="color: #a78bfa;">Live Demo</a>
        </p>
      </section>

      <!-- FAQ Section -->
      <section id="faq" class="section">
        <h2>Frequently Asked Questions (FAQ)</h2>

        <div class="endpoint-card">
          <h3 style="color: #a78bfa; margin-bottom: 1rem;">Payment & Facilitators</h3>
          
          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Why am I getting "Payment verification failed" with SOL payments?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> You must specify <span class="inline-code">"facilitator": "x402labs"</span> in your request body for SOL payments. 
            Without this, the system defaults to PayAI Network, which expects USDC payments and will fail when receiving SOL.
          </p>
<pre><code>// ‚úÖ Correct - Specify facilitator for SOL
{
  "method": "getSlot",
  "params": [],
  "chain": "solana",
  "facilitator": "x402labs"  // ‚Üê Required for SOL payments!
}</code></pre>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: What's the difference between x402labs and PayAI facilitators?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> They use different payment tokens:
          </p>
          <ul style="list-style-type: disc; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li><strong>x402labs ("x402labs"):</strong> Self-hosted facilitator using SOL payments. You send a signed SOL transfer transaction.</li>
            <li><strong>PayAI ("payai"):</strong> Network facilitator using USDC payments. PayAI handles settlement and broadcasting.</li>
          </ul>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Why do I need to send 890,880 lamports minimum for x402labs?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Solana requires accounts to hold at least 890,880 lamports to be rent-exempt. 
            The system automatically ensures SOL payments meet this minimum, even if the provider cost is lower.
            This prevents "InsufficientFundsForRent" errors.
          </p>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: What encoding should I use for signatures and transactions?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Encoding depends on the facilitator:
          </p>
          <ul style="list-style-type: disc; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li><strong>x402labs (SOL):</strong> Use base58 for publicKey, signature, and txBase64</li>
            <li><strong>PayAI (USDC):</strong> Use base64 for payload.transaction</li>
          </ul>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Should network be "solana" or "solana-mainnet"?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Either works! The backend automatically normalizes "solana" to "solana-mainnet".
          </p>
        </div>

        <div class="endpoint-card" style="margin-top: 2rem;">
          <h3 style="color: #a78bfa; margin-bottom: 1rem;">Pricing & Payments</h3>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: How much do payments cost?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Costs vary by facilitator:
          </p>
          <ul style="list-style-type: disc; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li><strong>x402labs (SOL):</strong> 890,880 lamports per call (~$0.0054 at $165/SOL) - fixed rent-exempt amount</li>
            <li><strong>PayAI (USDC):</strong> 100-200 micro-USDC per call (~$0.0001-$0.0002) - varies by provider</li>
          </ul>
          <p style="color: #94a3b8; margin-top: 1rem;">
            For micro-payments below $0.001, PayAI with USDC is more cost-effective than x402labs with SOL.
          </p>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: How are prices calculated for SOL payments?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> For x402labs facilitator, all SOL payments use the rent-exempt minimum of 890,880 lamports.
            This ensures the treasury wallet stays active on Solana and prevents "InsufficientFundsForRent" errors.
          </p>
          <ul style="list-style-type: disc; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li>All calls cost: 890,880 lamports (~$0.0054 USD at $165/SOL)</li>
            <li>This is required by Solana's rent-exemption rules</li>
            <li>For micro-payments, use PayAI with USDC instead</li>
          </ul>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Which facilitator should I use?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Depends on your preference:
          </p>
          <ul style="list-style-type: disc; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li><strong>x402labs ("x402labs"):</strong> Self-hosted, pay with SOL (890,880 lamports per call)</li>
            <li><strong>PayAI ("payai"):</strong> Network service, pay with USDC (100-200 micro-USDC per call, recommended for micro-payments)</li>
          </ul>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Are payments refundable if the RPC call fails?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> No, payments are final once settled on-chain. However, if payment verification fails BEFORE settlement,
            no transaction is broadcast and you don't lose funds.
          </p>
        </div>

        <div class="endpoint-card" style="margin-top: 2rem;">
          <h3 style="color: #a78bfa; margin-bottom: 1rem;">Technical Implementation</h3>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: What message should I sign for the payment intent?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Sign this exact JSON structure:
          </p>
<pre><code>{
  "amount": 749,  // From 402 response maxAmountRequired
  "to": "26AvBMEXaJAfA2R7wtQiPNYeWUd8QSi6rvy5i5W78vNR",  // payTo address
  "nonce": "1762303412466-0.7514463157105271",  // From 402 response extra.nonce
  "resource": "/rpc"
}

// Then:
const messageBytes = new TextEncoder().encode(JSON.stringify(intentMessage));
const signature = nacl.sign.detached(messageBytes, keypair.secretKey);
const signatureBase58 = bs58.encode(signature);</code></pre>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Is payment verification synchronous or asynchronous?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Verification is <strong>synchronous</strong> and completes in less than 1 second. 
            You get an immediate response (200 or 402). No polling or waiting required.
          </p>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Does the backend check my payment on-chain?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> For x402labs, the backend:
          </p>
          <ul style="list-style-type: disc; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li>Verifies your signature on the payment intent</li>
            <li>Validates your transaction structure</li>
            <li>Optionally simulates the transaction</li>
            <li>Broadcasts YOUR signed transaction to the network</li>
            <li>Waits for on-chain confirmation</li>
          </ul>
          <p style="color: #94a3b8; margin-top: 1rem;">
            The backend doesn't query for pre-existing transactions - it broadcasts the transaction you provide in <span class="inline-code">txBase64</span>.
          </p>

        </div>

        <div class="endpoint-card" style="margin-top: 2rem;">
          <h3 style="color: #a78bfa; margin-bottom: 1rem;">Troubleshooting</h3>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Error: "x402labs facilitator not available"</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> The backend is missing the <span class="inline-code">SOLANA_PRIVATE_KEY</span> environment variable. 
            Use PayAI instead or contact the server administrator.
          </p>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: How do I know which facilitator is available?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Check the 402 response:
          </p>
<pre><code>"extra": {
  "facilitator": {
    "primary": "x402labs",  // Primary facilitator
    "type": "x402labs",                   // Use this value
    "fallback": "PayAI Network"           // Backup if primary fails
  }
}</code></pre>
          <p style="color: #94a3b8; margin-top: 1rem;">
            Use the <span class="inline-code">type</span> value in your request body: <span class="inline-code">"facilitator": "x402labs"</span>
          </p>
        </div>

        <div class="endpoint-card" style="margin-top: 2rem;">
          <h3 style="color: #a78bfa; margin-bottom: 1rem;">Provider Selection</h3>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: How do I use QuickNode's Metaplex DAS API?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Use the <span class="inline-code">preferredProviders</span> preference:
          </p>
<pre><code>{
  "method": "getAssetSignatures",
  "params": [{"id": "HhbYrhZZ...", "limit": 10}],
  "chain": "solana",
  "preferences": {
    "preferredProviders": ["quicknode-solana"]
  },
  "facilitator": "x402labs"  // or "payai"
}</code></pre>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Which provider will be selected if I don't specify preferences?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> By default, the system uses "highest-priority" strategy:
          </p>
          <ul style="list-style-type: disc; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li>Helius (priority: 100) - Usually selected first for Solana</li>
            <li>QuickNode Base (priority: 80)</li>
            <li>Triton One (priority: 70)</li>
            <li>QuickNode Solana (priority: 65)</li>
          </ul>
          <p style="color: #94a3b8; margin-top: 1rem;">
            All providers are health-checked every 60 seconds. Only active providers are used.
          </p>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Can I force a specific provider?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Yes, use <span class="inline-code">preferredProviders</span>:
          </p>
<pre><code>{
  "method": "getSlot",
  "params": [],
  "chain": "solana",
  "preferences": {
    "preferredProviders": ["triton-solana"]  // Force Triton One
  }
}</code></pre>
        </div>

        <div class="endpoint-card" style="margin-top: 2rem;">
          <h3 style="color: #a78bfa; margin-bottom: 1rem;">Advanced</h3>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Do I need to broadcast my transaction before sending to backend?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> <strong>No!</strong> For x402labs, the flow is:
          </p>
          <ol style="list-style-type: decimal; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li>Build and sign the transaction with your wallet</li>
            <li>Serialize and encode to base58</li>
            <li>Send in <span class="inline-code">txBase64</span> field to backend</li>
            <li>Backend broadcasts and waits for confirmation</li>
            <li>Backend returns transaction signature</li>
          </ol>
          <p style="color: #94a3b8; margin-top: 1rem;">
            For PayAI, you partially sign with facilitator as fee payer, and PayAI completes and broadcasts the transaction.
          </p>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: How do batch payments work?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> See the <a href="#batch-payments" style="color: #a78bfa;">Batch Payments</a> section. 
            You can pre-pay for 1,000 calls at a 20% discount ($0.08 instead of $0.10), then use the batch ID for subsequent calls.
          </p>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: What's the difference between costPerCall in provider config?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> All costs are in USD:
          </p>
          <ul style="list-style-type: disc; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li>Triton One: $0.0001 USD = 890,880 lamports (SOL, rent-exempt) or 100 micro-USDC</li>
            <li>Helius: $0.00015 USD = 890,880 lamports (SOL, rent-exempt) or 150 micro-USDC</li>
            <li>QuickNode: $0.0002 USD = 890,880 lamports (SOL, rent-exempt) or 200 micro-USDC</li>
          </ul>
          <p style="color: #94a3b8; margin-top: 1rem;">
            <strong>Note:</strong> SOL payments use rent-exempt minimum (890,880 lamports) to ensure treasury wallet stays active.
          </p>
        </div>

        <div class="endpoint-card" style="margin-top: 2rem;">
          <h3 style="color: #a78bfa; margin-bottom: 1rem;">Getting Help</h3>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Where can I get support?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Multiple channels available:
          </p>
          <ul style="list-style-type: disc; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li><strong>Email:</strong> <a href="mailto:operations@x402labs.cloud" style="color: #a78bfa;">operations@x402labs.cloud</a></li>
            <li><strong>Documentation:</strong> <a href="/api-docs" style="color: #a78bfa;">Swagger UI</a> for interactive API explorer</li>
            <li><strong>Examples:</strong> <a href="/demo" style="color: #a78bfa;">Live Demo</a> with working code examples</li>
            <li><strong>GitHub:</strong> <a href="https://github.com/x402-labs" target="_blank" style="color: #a78bfa;">Issues and Discussions</a></li>
            <li><strong>Twitter:</strong> <a href="https://x.com/x402labs" target="_blank" style="color: #a78bfa;">@x402labs</a></li>
          </ul>

          <h4 style="color: #cbd5e1; margin-top: 1.5rem;">Q: Can I test without spending real SOL/USDC?</h4>
          <p style="color: #94a3b8; margin-bottom: 1rem;">
            <strong>A:</strong> Payments are on mainnet and use real tokens. However, amounts are micro-payments ($0.0001-$0.0002 per call).
            For testing, you can:
          </p>
          <ul style="list-style-type: disc; padding-left: 1.5rem; color: #e2e8f0; line-height: 1.8;">
            <li>Use the <a href="/demo" style="color: #a78bfa;">browser demo</a> to see the flow</li>
            <li>Make a single call (~$0.00015) to test integration</li>
            <li>Check provider health at <a href="/providers-ui" style="color: #a78bfa;">/providers</a> without payment</li>
          </ul>
        </div>
      </section>
    </main>
  </div>

  <!-- Real-Time Pricing Widget -->
  <script src="/shared-pricing-widget.js"></script>
</body>
</html>

