<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  
  <!-- SEO Meta Tags -->
  <title>API Reference | x402-RPC-Aggregator Documentation</title>
  <meta name="description" content="Complete API reference for x402-RPC-Aggregator. Learn how to integrate intelligent RPC routing with x402 micropayments in your AI agents and dApps." />
  <meta name="keywords" content="x402 API, RPC API, Solana API, Ethereum API, blockchain API, micropayments API" />
  
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“–</text></svg>" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background: #0f172a;
      color: #f1f5f9;
      line-height: 1.6;
    }
    
    code, pre {
      font-family: 'JetBrains Mono', monospace;
    }
    
    /* Header */
    header {
      background: rgba(30, 41, 59, 0.5);
      backdrop-filter: blur(10px);
      padding: 1rem 2rem;
      position: sticky;
      top: 0;
      z-index: 100;
      border-bottom: 1px solid rgba(139, 92, 246, 0.1);
    }
    
    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .logo {
      font-size: 1.25rem;
      font-weight: 700;
      color: #a78bfa;
      text-decoration: none;
    }
    
    nav {
      display: flex;
      gap: 2rem;
    }
    
    nav a {
      color: #cbd5e1;
      text-decoration: none;
      font-weight: 500;
    }
    
    nav a:hover {
      color: #a78bfa;
    }
    
    /* Layout */
    .container {
      display: grid;
      grid-template-columns: 250px 1fr;
      max-width: 1400px;
      margin: 0 auto;
      min-height: calc(100vh - 73px);
    }
    
    /* Sidebar */
    .sidebar {
      background: rgba(30, 41, 59, 0.3);
      padding: 2rem 1.5rem;
      border-right: 1px solid rgba(139, 92, 246, 0.1);
      position: sticky;
      top: 73px;
      height: calc(100vh - 73px);
      overflow-y: auto;
    }
    
    .sidebar h3 {
      font-size: 0.875rem;
      color: #64748b;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 1rem;
      margin-top: 2rem;
    }
    
    .sidebar h3:first-child {
      margin-top: 0;
    }
    
    .sidebar ul {
      list-style: none;
    }
    
    .sidebar li {
      margin-bottom: 0.5rem;
    }
    
    .sidebar a {
      color: #cbd5e1;
      text-decoration: none;
      font-size: 0.9rem;
      display: block;
      padding: 0.5rem;
      border-radius: 0.375rem;
      transition: all 0.2s;
    }
    
    .sidebar a:hover,
    .sidebar a.active {
      background: rgba(139, 92, 246, 0.1);
      color: #a78bfa;
    }
    
    /* Content */
    .content {
      padding: 3rem;
    }
    
    .section {
      margin-bottom: 4rem;
    }
    
    h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, #f1f5f9 0%, #a78bfa 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    h2 {
      font-size: 2rem;
      margin-top: 3rem;
      margin-bottom: 1.5rem;
      color: #e2e8f0;
      border-bottom: 1px solid rgba(139, 92, 246, 0.2);
      padding-bottom: 0.5rem;
    }
    
    h3 {
      font-size: 1.5rem;
      margin-top: 2rem;
      margin-bottom: 1rem;
      color: #cbd5e1;
    }
    
    p {
      color: #cbd5e1;
      margin-bottom: 1rem;
      max-width: 800px;
    }
    
    /* Code Blocks */
    pre {
      background: #1e293b;
      border-radius: 0.75rem;
      padding: 1.5rem;
      overflow-x: auto;
      margin: 1.5rem 0;
      border: 1px solid rgba(139, 92, 246, 0.2);
    }
    
    code {
      color: #10b981;
      font-size: 0.9rem;
    }
    
    .inline-code {
      background: rgba(139, 92, 246, 0.1);
      padding: 0.2rem 0.5rem;
      border-radius: 0.25rem;
      color: #a78bfa;
      font-size: 0.9em;
    }
    
    /* API Endpoint Cards */
    .endpoint-card {
      background: rgba(30, 41, 59, 0.5);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
      border: 1px solid rgba(139, 92, 246, 0.2);
    }
    
    .endpoint-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    
    .method {
      background: #10b981;
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 0.375rem;
      font-weight: 600;
      font-size: 0.875rem;
    }
    
    .method.post {
      background: #3b82f6;
    }
    
    .method.get {
      background: #10b981;
    }
    
    .endpoint-path {
      font-family: 'JetBrains Mono', monospace;
      color: #a78bfa;
      font-weight: 500;
    }
    
    .parameter-table {
      width: 100%;
      margin: 1.5rem 0;
      border-collapse: collapse;
    }
    
    .parameter-table th {
      text-align: left;
      padding: 0.75rem;
      background: rgba(139, 92, 246, 0.1);
      border-bottom: 1px solid rgba(139, 92, 246, 0.2);
      font-size: 0.875rem;
      color: #cbd5e1;
    }
    
    .parameter-table td {
      padding: 0.75rem;
      border-bottom: 1px solid rgba(139, 92, 246, 0.1);
      color: #94a3b8;
    }
    
    .parameter-name {
      font-family: 'JetBrains Mono', monospace;
      color: #a78bfa;
    }
    
    .required {
      background: #ef4444;
      color: white;
      padding: 0.125rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      font-weight: 600;
      margin-left: 0.5rem;
    }
    
    .optional {
      background: #64748b;
      color: white;
      padding: 0.125rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      font-weight: 600;
      margin-left: 0.5rem;
    }
    
    /* Response Examples */
    .response-tabs {
      display: flex;
      gap: 1rem;
      margin: 1.5rem 0 0;
    }
    
    .tab {
      background: rgba(139, 92, 246, 0.1);
      color: #cbd5e1;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem 0.5rem 0 0;
      cursor: pointer;
      font-weight: 500;
      font-size: 0.875rem;
    }
    
    .tab.active {
      background: #1e293b;
      color: #a78bfa;
    }
    
    /* Status Badge */
    .status-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      font-weight: 600;
      margin-left: 1rem;
    }
    
    .status-badge.live {
      background: #10b981;
      color: white;
    }
    
    .status-badge.beta {
      background: #f59e0b;
      color: white;
    }
    
    /* Quick Links */
    .quick-links {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin: 2rem 0;
    }
    
    .quick-link {
      background: rgba(139, 92, 246, 0.1);
      padding: 1.5rem;
      border-radius: 0.75rem;
      border: 1px solid rgba(139, 92, 246, 0.2);
      text-decoration: none;
      color: inherit;
      transition: all 0.3s;
    }
    
    .quick-link:hover {
      transform: translateY(-3px);
      border-color: rgba(139, 92, 246, 0.4);
    }
    
    .quick-link h4 {
      color: #a78bfa;
      margin-bottom: 0.5rem;
    }
    
    .quick-link p {
      font-size: 0.875rem;
      color: #94a3b8;
    }
    
    @media (max-width: 1024px) {
      .container {
        grid-template-columns: 1fr;
      }
      
      .sidebar {
        display: none;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="header-content">
      <a href="/" class="logo">âš¡ x402-RPC API Docs</a>
      <nav>
        <a href="/">Home</a>
        <a href="/demo">Demo</a>
        <a href="/api-docs">Swagger</a>
        <a href="https://github.com/x402-labs/x402-rpc-aggregator" target="_blank">GitHub</a>
      </nav>
    </div>
  </header>

  <!-- Main Container -->
  <div class="container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <h3>Getting Started</h3>
      <ul>
        <li><a href="#introduction" class="active">Introduction</a></li>
        <li><a href="#quick-start">Quick Start</a></li>
        <li><a href="#authentication">Authentication</a></li>
      </ul>
      
      <h3>Core API</h3>
      <ul>
        <li><a href="#rpc-endpoint">RPC Endpoint</a></li>
        <li><a href="#health">Health Check</a></li>
        <li><a href="#providers">Providers</a></li>
      </ul>
      
      <h3>Advanced</h3>
      <ul>
        <li><a href="#routing">Routing Strategies</a></li>
        <li><a href="#batch-payments">Batch Payments</a></li>
        <li><a href="#error-handling">Error Handling</a></li>
      </ul>
      
      <h3>SDKs</h3>
      <ul>
        <li><a href="#javascript">JavaScript</a></li>
        <li><a href="#python">Python</a></li>
        <li><a href="#curl">cURL</a></li>
      </ul>
    </aside>

    <!-- Main Content -->
    <main class="content">
      <!-- Introduction -->
      <section id="introduction" class="section">
        <h1>API Reference</h1>
        <p>
          Complete documentation for integrating x402-RPC-Aggregator into your applications. 
          This API provides intelligent RPC routing with built-in x402 micropayment support for Solana, Ethereum, and Base chains.
        </p>
        
        <div class="quick-links">
          <a href="#quick-start" class="quick-link">
            <h4>ðŸš€ Quick Start</h4>
            <p>Get started in 5 minutes</p>
          </a>
          <a href="/demo" class="quick-link">
            <h4>ðŸŽ® Live Demo</h4>
            <p>Try it in your browser</p>
          </a>
          <a href="/api-docs" class="quick-link">
            <h4>ðŸ“Š Swagger UI</h4>
            <p>Interactive API explorer</p>
          </a>
          <a href="https://github.com/x402-labs/x402-rpc-aggregator" class="quick-link">
            <h4>ðŸ’» GitHub</h4>
            <p>View source code</p>
          </a>
        </div>
      </section>

      <!-- Quick Start -->
      <section id="quick-start" class="section">
        <h2>Quick Start</h2>
        <p>Make your first RPC call in less than 5 minutes.</p>
        
        <h3>1. Make an RPC Request</h3>
<pre><code>curl -X POST https://x402labs.cloud/rpc \
  -H "Content-Type: application/json" \
  -d '{
    "method": "getSlot",
    "chain": "solana"
  }'</code></pre>

        <h3>2. Receive 402 Payment Challenge</h3>
<pre><code>{
  "invoice": {
    "amount": 0.0001,
    "to": "FacilitatorWalletAddress...",
    "network": "solana-mainnet",
    "provider": "Triton One",
    "nonce": "1730000000000-abc123"
  }
}</code></pre>

        <h3>3. Pay and Retry (Automatic with SDK)</h3>
<pre><code>import { X402Agent } from './x402-client';

const agent = new X402Agent('https://x402labs.cloud/');
const result = await agent.callRPC('getSlot', [], 'solana');

console.log('Slot:', result.result);
console.log('Tx Hash:', result.x402.paymentInfo.txHash);</code></pre>
      </section>

      <!-- Authentication -->
      <section id="authentication" class="section">
        <h2>Authentication <span class="status-badge live">LIVE</span></h2>
        <p>
          x402-RPC-Aggregator uses the x402 protocol for authentication. Instead of API keys, 
          you pay per request using USDC micropayments on Solana or Base.
        </p>
        
        <h3>Payment Flow</h3>
        <ol style="margin-left: 2rem; color: #cbd5e1;">
          <li>Make request without payment â†’ Receive 402 with invoice</li>
          <li>Sign payment with wallet (Phantom/MetaMask)</li>
          <li>Retry request with <span class="inline-code">x402-payment</span> header</li>
          <li>Facilitator verifies & settles payment</li>
          <li>Receive RPC response with receipt</li>
        </ol>
      </section>

      <!-- RPC Endpoint -->
      <section id="rpc-endpoint" class="section">
        <h2>RPC Endpoint <span class="status-badge live">LIVE</span></h2>
        
        <div class="endpoint-card">
          <div class="endpoint-header">
            <span class="method post">POST</span>
            <span class="endpoint-path">/rpc</span>
          </div>
          
          <p>Execute an RPC call with intelligent provider routing and x402 payment.</p>
          
          <h3>Request Body</h3>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="parameter-name">method</span><span class="required">required</span></td>
                <td>string</td>
                <td>RPC method name (e.g., "getSlot", "eth_blockNumber")</td>
              </tr>
              <tr>
                <td><span class="parameter-name">params</span><span class="optional">optional</span></td>
                <td>array</td>
                <td>Method parameters (default: [])</td>
              </tr>
              <tr>
                <td><span class="parameter-name">chain</span><span class="optional">optional</span></td>
                <td>string</td>
                <td>Blockchain: "solana" | "ethereum" | "base" (default: "solana")</td>
              </tr>
              <tr>
                <td><span class="parameter-name">preferences</span><span class="optional">optional</span></td>
                <td>object</td>
                <td>Routing preferences (see <a href="#routing" style="color: #a78bfa;">Routing Strategies</a>)</td>
              </tr>
            </tbody>
          </table>
          
          <h3>Response (200 Success)</h3>
<pre><code>{
  "jsonrpc": "2.0",
  "id": 1,
  "result": 182456789,
  "x402": {
    "provider": "Triton One",
    "paymentInfo": {
      "provider": "solana",
      "chain": "solana",
      "txHash": "5x...",
      "amount": 0.0001,
      "explorer": "https://orb.helius.dev/tx/5x..."
    },
    "cost": 0.0001,
    "status": "settled"
  }
}</code></pre>

          <h3>Response (402 Payment Required)</h3>
<pre><code>{
  "invoice": {
    "amount": 0.0001,
    "to": "FacilitatorWallet...",
    "network": "solana-mainnet",
    "resource": "/rpc",
    "nonce": "unique-nonce",
    "provider": "Triton One",
    "batchOption": {
      "calls": 1000,
      "price": 0.08,
      "savings": "20%"
    }
  }
}</code></pre>
        </div>
      </section>

      <!-- Health Endpoint -->
      <section id="health" class="section">
        <h2>Health Check</h2>
        
        <div class="endpoint-card">
          <div class="endpoint-header">
            <span class="method get">GET</span>
            <span class="endpoint-path">/health</span>
          </div>
          
          <p>Check service health and provider status.</p>
          
<pre><code>curl https://x402labs.cloud//health</code></pre>

          <h3>Response</h3>
<pre><code>{
  "status": "ok",
  "timestamp": "2025-10-27T12:00:00.000Z",
  "version": "1.0.0",
  "chains": ["solana", "ethereum", "base"],
  "stats": {
    "totalProviders": 8,
    "activeProviders": 8,
    "healthyProviders": 7,
    "averageLatency": 312
  }
}</code></pre>
        </div>
      </section>

      <!-- Providers Endpoint -->
      <section id="providers" class="section">
        <h2>List Providers</h2>
        
        <div class="endpoint-card">
          <div class="endpoint-header">
            <span class="method get">GET</span>
            <span class="endpoint-path">/providers</span>
          </div>
          
          <p>Get list of all RPC providers with real-time health status.</p>
          
          <h3>Query Parameters</h3>
          <table class="parameter-table">
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="parameter-name">chain</span><span class="optional">optional</span></td>
                <td>string</td>
                <td>Filter by chain: "solana" | "ethereum" | "base"</td>
              </tr>
            </tbody>
          </table>
          
<pre><code>curl 'https://x402labs.cloud//providers?chain=solana'</code></pre>

          <h3>Response</h3>
<pre><code>{
  "providers": [
    {
      "id": "triton-solana",
      "name": "Triton One",
      "chains": ["solana"],
      "costPerCall": 0.0001,
      "batchCost": { "calls": 1000, "price": 0.08 },
      "status": "active",
      "priority": 100,
      "averageLatency": 245
    }
  ],
  "total": 1
}</code></pre>
        </div>
      </section>

      <!-- Routing Strategies -->
      <section id="routing" class="section">
        <h2>Routing Strategies <span class="status-badge live">LIVE</span></h2>
        <p>Customize how the aggregator selects RPC providers for your requests.</p>
        
        <h3>Available Strategies</h3>
        
        <div class="endpoint-card">
          <h4>1. Lowest Cost (Default)</h4>
          <p>Selects the provider with the lowest cost per call.</p>
<pre><code>{
  "method": "getSlot",
  "chain": "solana",
  "preferences": {
    "strategy": "lowest-cost"
  }
}</code></pre>
        </div>

        <div class="endpoint-card">
          <h4>2. Lowest Latency</h4>
          <p>Selects the fastest provider based on real-time health checks.</p>
<pre><code>{
  "method": "getSlot",
  "chain": "solana",
  "preferences": {
    "strategy": "lowest-latency",
    "maxLatencyMs": 2000
  }
}</code></pre>
        </div>

        <div class="endpoint-card">
          <h4>3. Highest Priority</h4>
          <p>Uses premium providers first (e.g., Triton One for Solana).</p>
<pre><code>{
  "method": "getSlot",
  "chain": "solana",
  "preferences": {
    "strategy": "highest-priority"
  }
}</code></pre>
        </div>

        <div class="endpoint-card">
          <h4>4. Round Robin</h4>
          <p>Distributes load evenly across all providers.</p>
<pre><code>{
  "method": "getSlot",
  "chain": "solana",
  "preferences": {
    "strategy": "round-robin"
  }
}</code></pre>
        </div>
      </section>

      <!-- Batch Payments -->
      <section id="batch-payments" class="section">
        <h2>Batch Payments <span class="status-badge live">LIVE</span></h2>
        <p>Purchase multiple calls upfront for discounted pricing (20% savings).</p>
        
        <h3>Get Batch Pricing</h3>
<pre><code>curl 'https://x402labs.cloud/batch-pricing?chain=solana'</code></pre>

        <h3>Response</h3>
<pre><code>{
  "chain": "solana",
  "batchOptions": [
    {
      "providerId": "triton-solana",
      "providerName": "Triton One",
      "calls": 1000,
      "price": 0.08,
      "pricePerCall": 0.00008,
      "savings": "20.0%"
    }
  ]
}</code></pre>

        <h3>Purchase Batch</h3>
        <p>Include <span class="inline-code">batchPurchase: true</span> in payment payload to buy a batch.</p>
        
        <h3>Use Batch</h3>
        <p>Include batch ID in header for subsequent calls:</p>
<pre><code>curl -X POST /rpc \
  -H "x402-batch: {\"batchId\": \"batch_123...\"}" \
  -d '{"method":"getSlot","chain":"solana"}'</code></pre>
      </section>

      <!-- Error Handling -->
      <section id="error-handling" class="section">
        <h2>Error Handling</h2>
        
        <h3>HTTP Status Codes</h3>
        <table class="parameter-table">
          <thead>
            <tr>
              <th>Code</th>
              <th>Meaning</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>200</strong></td>
              <td>Success</td>
              <td>Payment settled, RPC executed</td>
            </tr>
            <tr>
              <td><strong>402</strong></td>
              <td>Payment Required</td>
              <td>Pay invoice and retry</td>
            </tr>
            <tr>
              <td><strong>400</strong></td>
              <td>Bad Request</td>
              <td>Check request parameters</td>
            </tr>
            <tr>
              <td><strong>404</strong></td>
              <td>Not Found</td>
              <td>Check endpoint URL</td>
            </tr>
            <tr>
              <td><strong>500</strong></td>
              <td>Server Error</td>
              <td>Retry with fallback provider</td>
            </tr>
          </tbody>
        </table>
      </section>

      <!-- JavaScript SDK -->
      <section id="javascript" class="section">
        <h2>JavaScript/TypeScript SDK</h2>
        
<pre><code>import { X402Agent } from './lib/x402-client';

// Initialize agent
const agent = new X402Agent('https://x402labs.cloud/');

// Make RPC call (handles payment automatically)
const result = await agent.callRPC('getSlot', [], 'solana');

console.log('Current slot:', result.result);
console.log('Payment tx:', result.x402.paymentInfo.txHash);</code></pre>

        <h3>With Preferences</h3>
<pre><code>const result = await agent.callRPC(
  'getBalance',
  ['SomeWalletAddress...'],
  'solana',
  {
    strategy: 'lowest-latency',
    maxLatencyMs: 1500,
    preferredProviders: ['triton-solana']
  }
);</code></pre>
      </section>

      <!-- Python Example -->
      <section id="python" class="section">
        <h2>Python (Concept)</h2>
        
<pre><code>from x402_client import X402Agent

# Initialize
agent = X402Agent('https://x402labs.cloud/')

# Make call
result = agent.call_rpc('getSlot', [], chain='solana')
print(f"Slot: {result['result']}")
print(f"Tx: {result['x402']['paymentInfo']['txHash']}")</code></pre>
      </section>

      <!-- cURL Examples -->
      <section id="curl" class="section">
        <h2>cURL Examples</h2>
        
        <h3>Solana - Get Slot</h3>
<pre><code>curl -X POST https://x402labs.cloud/rpc \
  -H "Content-Type: application/json" \
  -d '{
    "method": "getSlot",
    "chain": "solana"
  }'</code></pre>

        <h3>Ethereum - Block Number</h3>
<pre><code>curl -X POST https://x402labs.cloud/rpc \
  -H "Content-Type: application/json" \
  -d '{
    "method": "eth_blockNumber",
    "chain": "ethereum"
  }'</code></pre>

        <h3>With Custom Routing</h3>
<pre><code>curl -X POST https://x402labs.cloud/rpc \
  -H "Content-Type: application/json" \
  -d '{
    "method": "getSlot",
    "chain": "solana",
    "preferences": {
      "strategy": "lowest-latency",
      "maxLatencyMs": 2000
    }
  }'</code></pre>
      </section>

      <!-- Footer -->
      <section style="margin-top: 6rem; padding-top: 3rem; border-top: 1px solid rgba(139, 92, 246, 0.1);">
        <p style="color: #64748b; text-align: center;">
          Need help? Check out <a href="https://github.com/x402-labs" style="color: #a78bfa;">GitHub</a> or visit the 
          <a href="/demo" style="color: #a78bfa;">Live Demo</a>
        </p>
      </section>
    </main>
  </div>
</body>
</html>

